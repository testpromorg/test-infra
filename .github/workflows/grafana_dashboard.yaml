name: Grafana Dashboard Apply
on:
  push:
    branches:
    - master
    paths:
    - 'prombench/manifests/cluster-infra/grafana_dashboard_dashboards_noparse.yaml'
jobs:
  apply_grafana_dashboard:
    name: Apply Configmap
    runs-on: ubuntu-latest
    steps:
    - name: Hello World
      id: hello_world
      uses: docker://prombench/prombench:2.0.2
      env:
        AUTH_FILE: ${{ secrets.PROMBENCH_GKE_AUTH }}
        PROJECT_ID: prombench-gsoc
        CLUSTER_NAME: prombench
        ZONE: europe-west3-a
        TEST_INFRA_REPO: https://github.com/testpromorg/test-infra.git
      with:
        args: >-
          ./prombench gke resource apply -a $AUTH_FILE
          -v PROJECT_ID:$PROJECT_ID -v ZONE:$ZONE
          -v CLUSTER_NAME:$CLUSTER_NAME
          -f manifests/cluster-infra/grafana_dashboard_dashboards_noparse.yaml